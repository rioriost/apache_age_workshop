# Apache AGEの紹介

## Apache AGEとは何か

[Apache AGE](https://age.apache.org)は、その名前 (Apache Graph Extension) が示す通り、グラフデータを扱うためのPostgreSQLの拡張機能です。

グラフデータは、ノードとエッジの組み合わせとして表現されます：ノードはエンティティやデータの要素を表し、エッジはそれらの間の関係を表します。

ノードとエッジの両方には、それらに関連するプロパティ（属性）があります。AGEは、Cypherと呼ばれるクエリ言語を使用してグラフデータを操作することができます。
Cypherをサポートしている最も有名なグラフデータベースはNeo4jですが、Apache TinkerPopというグラフフレームワークで実装された[Gremlin](https://tinkerpop.apache.org/gremlin.html)など、他のクエリ言語もあります。

## なぜグラフデータベースなのか？
上記で述べたように、AGEはグラフデータを扱うことができます。しかし、なぜ私たちはグラフデータについて考える必要があるのでしょうか？

リレーショナルデータやドキュメントデータとは異なり、グラフデータは複雑で高度に相互接続された関係を表現するのに優れています。グラフデータを使用する主な利点の一つは、関係を効率的かつ直感的にモデル化し、クエリを行う能力です。

リレーショナルデータベースでは、接続を探るために複数のテーブルを結合すると、特に関係の数が増えると、複雑でパフォーマンスが重くなることがあります。ドキュメントデータベースは柔軟性がありますが、エンティティ間の深い関係を探索するのに最適化されていません。

一方、グラフデータは自然にエンティティ（ノード）とそのリレーション（エッジ）を表現し、ソーシャルネットワーク、レコメンデーションシステム、詐欺検出、ネットワーク分析、知識グラフなどのユースケースに理想的です。"友達の友達"や"二点間の最短経路"など、複数レベルのリレーションを含むクエリは、グラフデータベースでの方がはるかに効率的で表現力があります。

ユーザーの"友達の友達"を取得するケースを比較してみましょう。

標準的なSQLクエリでは：

```sql
SELECT DISTINCT fof.name
FROM users u
JOIN friendships f1 ON u.id = f1.user_id
JOIN users f ON f1.friend_id = f.id
JOIN friendships f2 ON f.id = f2.user_id
JOIN users fof ON f2.friend_id = fof.id
WHERE u.name = 'Alice';
```

Cypherクエリでは：

```cypher
MATCH (u:User {name: 'Alice'})-[:FRIEND]->(:User)-[:FRIEND]->(fof)
RETURN DISTINCT fof.name
```

見ての通り、Cypherクエリはより簡潔で表現力があり、理解しやすく保守しやすいです。

## AIとグラフデータ

そして、他の多くの分野と同様に、生成型AIの波はグラフデータの世界にも到達しています。
RAG（Retrieval-Augmented Generation）の検索と生成の精度の限界が広く認識されるようになると、知識グラフが次の有望なアプローチの一つとして注目を集めています。

知識グラフは、事実や概念をノードとして、それらの間の関係をエッジとして表現します。
例えば、「エリザベス1世がイングランドとアイルランドを統治し、スペインと戦った」という事実は、「エリザベス1世」、「イングランド」、「アイルランド」、「スペイン」といったノードと、「統治した」、「戦った」といったエッジでグラフとして表現することができます。

このようなネットワーク構造を活用することで、AIによる検索と生成の結果が大幅に改善されることが期待されています。

[次へ：AGEの有効化方法](02_enablement_ja.md)
